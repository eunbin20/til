# Redux style guide

#### 중요도A

###### - 상태를 직접적으로 수정하지 마라.

  상태를 직접적으로 수정하는 것은 리덕스에서 버그를 유발하는 가장 보편적인 요인이다. 이 버그가 발생하면 컴포넌트는 제대로 리렌더링되지 못하고 리덕스 개발자도구를 해용해 디버깅을 하는 데 많은 시간이 소요됩니다. reducer나 어플리케이션 코드 안에서나 직접으로 state를 변화시키는 것은 언제나 피해야 한다.

  `redux-immutable-state-invariant`와 같은 도구를 사용하면 개발 중에 state를 직접적으로 수정하는 것을 잡아낼 수 있고 `Immer`은 의도치않게 state가 변경되는 것을 방지해준다.

  Note: 존재하는 값을 복사하여 수정하는 것은 괜찮다. 이것은 갱신하는 로직을 불변하게 만드는 일반적인 부분이다. 또한, `Immer` 라이브러리를 사용하면 실제 값이 변하는 것이 아니기 때문에 "수정"하는 로직을 작성하는 것이 가능하다. `Immer`는 내부적으로 변화를 감지하고 불변적인 갱신 로직을 생성해준다.
  </br>

###### - Reducer함수는 순수해야한다.
  reducer함수는 오직 그 함수의 `state`와 `action`인자에 달려있다. 그리고 이 인자들만을 이요해 작업을 수행하고 값을 반환해야 한다. 이 함수에서는 **비동기적인 실행(AJAX 호출, timeout, promise 등)을 하거나 무작위적인 값(Date.now(), Math.random())을 생성하거나, reducer함수 외부의 값을 변화시키거나, 외부의 코드에 영향을 주는 코드를 작성 해서는 안된다.**
  </br>

###### - Serialize할 수 없는 값을 state나 action에 넣지 마라.
  Promise, Symbols, Map/Set 객체, 함수, 클래스의 인스턴스 등 serialize할 수 없는(나열할 수 없는?)값들을 삽입하는 것은 피해라. 이것은 redux의 디버깅 툴을 이용해 디버깅이 예상대로 작동하고 UI가 예상대로 갱신되는 것을 보장해준다.

  예외: 미들웨어때문에 reducer함수에 도달하기 전에 중단되는 경우에는 state나 action에 serialize할 수 없는 값을 삽입할 수 있다. 이러한 미들웨어로는 `redux-thunk`, `redux-promise`등이 있다.
  </br>

###### - 한 어플리케이션 당 store는 하나다.
  표준적인 redux 어플리케이션은 전체 어플리케이션에 사용되는 한 개의 redux store 인스턴스를 가져야 한다. 이것은 전형적으로 store.js와 같은 분리된 파일에서 정의된다.

  이상적으로는, 어플리케이션의 로직이 store를 직접적으로 import하는 것은 좋지 않다. 이것은 <Provider>를 통해 리액트 컴포넌트를 통과할 것이다. 또는 thunk와 같은 미들웨어를 통해 간접적으로 참조할 것이다. 극히 드문 경우에, 다른 로직 파일들에서 store를 import하는 것이 필요할 수도 있지만, 이것은 최후의 수단이 되어야 한다.
</br>

#### 중요도B

###### - Redux toolkit을 사용하여 리덕스 로직을 작성해라.
  `redux toolkit`은 리덕스를 사용할 때 추천하는 툴셋이다. 이것은 우리가 제안하는 모범적인 실행 사례들을 만드는 함수를 포함하고 있다. 이 사례들에는 수정을 감자하기 위해 stor를 세팅하는 것과 리덕스 개발자도구 extension을 사용할 수 있게 하는 것, Immer를 이용해 불변하는 update 로직을 단순화하는 것들이 포함되어있다.

  꼭 RTK(Redux ToolKit)를 사용할 필요는 없습니다. 필요하다면 다른 방안을 사용하는 것도 가능합니다. 그러나 RTK를 사용하면 당신의 로직이 단순해지고 당신의 어플리케이션이 좋은 기본값으로 설정될 것입니다.
  </br>

###### - Immer를 이용해 불변성이 보장되는 로직을 작성해라.
  불변적으로 update되는 로직을 직접 작성하는 것은 빈번하게 어렵고 에러를 발생시키기 쉽다. `Immer`는 당신이 '변하는' 로직을 작성하면서 불변적인 update로직을 간단히 작성할 수 있게 해준다. 그리고 당신의 개발중인 state를 정지시켜 변화를 캐치할 수도 있다. 우리는 불변하는 로직을 작성하기 위해 Immer를 사용하는 것을 추천한다. 가급적이면 redux toolkit의 한 부분으로서.
  </br> 

###### - 기능 별 디렉토리 구조를 이용하여 파일 구조를 구성해라.

###### - 리듀서에 가능한 많은 로직을 넣어라

###### - 리듀서들은 각 상태에 대한 구조를 소유해야한다.

###### - slice는 저장되는 데이터에 기반하여 이름을 지어라

###### - 상태 구조는 컴포넌트가 아닌, 데이터 종류에 따라 구성해라

###### - 중첩되고 복잡한 상태를 정규화시켜라.

###### - 액션은 이벤트처럼 다루어라.

###### - 의미있는 액션 이름을 사용해라

###### - 하나의 액션에 여러 개의 리듀서가 반응할 수 있게 해라

###### - 여러 개의 액션을 연속적으로 발생시키지 마라.

###### - 상태가 위치해야 하는 곳(리덕스 vs 로컬)에 대해 잘 판단해라.

###### - React Redux Hooks를 활용해라.

###### - 리덕스 스토어에서 데이터를 읽어서 사용하도록 더 많은 컴포넌트들을 연결해라.

###### - 함수형 컴포넌트 내부에서 `useSelector`를 여러번 호출해라.

###### - 정적 타입 체킹 도구들을 사용해라.

###### - 디버깅을 위해 리덕스 개발 확장 프로그램을 사용해라.

###### - 상태 데이터는 Plain JS 객체를 활용해라


#### 중요도B

###### - domain/eventName 형식의 액션 이름을 사용해라

###### - 비동기 로직은 Thunk를 이용해라.

###### - 액션 생성 함수를 사용해라

###### - 복잡한 로직은 컴포넌트 외부로 분리해라.

###### - 스토어의 상태를 읽기 위해 Selector함수를 사용해라.

###### - Selector함수의 이름은 select로 시작하게끔 작성해라.

###### - "대부분의" Form 관련 상태는 리적스에서 관리하지 마라.
